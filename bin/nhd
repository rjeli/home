#!/bin/bash
set -euo pipefail

curRef="$HOME/repos/home"
prevRef="$curRef?ref=HEAD"

brewfileAttr="darwinConfigurations.rj-m4.config.homebrew.brewfile"

# curBrewfile=$(nix eval --raw "$curRef#$brewfileAttr")
curBrewfile=$(cat /etc/Brewfile)
prevBrewfile=$(nix eval --raw "$prevRef#$brewfileAttr")

# printf "$curBrewfile"

# echo -e CUR: $curBrewfile
# echo -e PREV: $prevBrewfile

echo diff:
difft <(echo "$prevBrewfile") <(echo "$curBrewfile")
